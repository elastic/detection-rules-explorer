{"pageProps":{"rule":{"metadata":{"creation_date":"2023/05/12","integration":["cloud_defend"],"maturity":"production","updated_date":"2024/05/21"},"rule":{"author":["Elastic"],"description":"This rule detects an SSH or SSHD process executed from inside a container. This includes both the client ssh binary and\nserver ssh daemon process. SSH usage inside a container should be avoided and monitored closely when necessary. With\nvalid credentials an attacker may move laterally to other containers or to the underlying host through container\nbreakout. They may also use valid SSH credentials as a persistence mechanism.\n","false_positives":["    SSH usage may be legitimate depending on the environment. Access patterns and follow-on activity should be analyzed\n    to distinguish between authorized and potentially malicious behavior.\n    "],"from":"now-6m","index":["logs-cloud_defend*"],"interval":"5m","language":"eql","license":"Elastic License v2","name":"SSH Process Launched From Inside A Container","references":["https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/SSH%20server%20running%20inside%20container/","https://www.blackhillsinfosec.com/sshazam-hide-your-c2-inside-of-ssh/"],"risk_score":73,"rule_id":"03a514d9-500e-443e-b6a9-72718c548f6c","severity":"high","tags":["Data Source: Elastic Defend for Containers","Domain: Container","OS: Linux","Use Case: Threat Detection","Tactic: Lateral Movement","Tactic: Persistence","Language: eql"],"timestamp_override":"event.ingested","type":"eql","query":"process where container.id: \"*\" and event.type== \"start\" and\nevent.action in (\"fork\", \"exec\") and event.action != \"end\" and \nprocess.name: (\"sshd\", \"ssh\", \"autossh\")\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021/","subtechnique":[{"id":"T1021.004","name":"SSH","reference":"https://attack.mitre.org/techniques/T1021/004/"}]}],"tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008/"}},{"framework":"MITRE ATT&CK","technique":[{"id":"T1133","name":"External Remote Services","reference":"https://attack.mitre.org/techniques/T1133/"}],"tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"}}]}}},"__N_SSG":true}