{"pageProps":{"rule":{"metadata":{"creation_date":"2023/01/22","integration":["windows"],"maturity":"production","min_stack_comments":"Build time field required_fields divergence between -8.7 and 8.8+ due to schema versions.","min_stack_version":"8.8.0","updated_date":"2023/06/29"},"rule":{"author":["Elastic"],"description":"Identifies access attempts to LSASS handle, this may indicate an attempt to dump credentials from Lsass memory.\n","from":"now-9m","index":["winlogbeat-*","logs-windows.*"],"language":"eql","license":"Elastic License v2","name":"Suspicious Lsass Process Access","note":"## Setup\nIf enabling an EQL rule on a non-elastic-agent index (such as beats) for versions <8.2, events will not define `event.ingested` and default fallback for EQL rules was not added until 8.2, so you will need to add a custom pipeline to populate `event.ingested` to @timestamp for this rule to work.\n","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md"],"risk_score":47,"rule_id":"128468bf-cab1-4637-99ea-fdf3780a4609","severity":"medium","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Credential Access","Data Source: Sysmon Only"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"windows\" and event.code == \"10\" and\n  winlog.event_data.TargetImage : \"?:\\\\WINDOWS\\\\system32\\\\lsass.exe\" and\n  not winlog.event_data.GrantedAccess :\n                (\"0x1000\", \"0x1400\", \"0x101400\", \"0x101000\", \"0x101001\", \"0x100000\", \"0x100040\", \"0x3200\", \"0x40\", \"0x3200\") and\n  not process.name : (\"procexp64.exe\", \"procmon.exe\", \"procexp.exe\", \"Microsoft.Identity.AadConnect.Health.AadSync.Host.ex\") and\n  not process.executable :\n            (\"?:\\\\Windows\\\\System32\\\\lsm.exe\",\n             \"?:\\\\Program Files\\\\*\",\n             \"?:\\\\Program Files (x86)\\\\*\",\n             \"?:\\\\Windows\\\\System32\\\\msiexec.exe\",\n             \"?:\\\\Windows\\\\CCM\\\\CcmExec.exe\",\n             \"?:\\\\Windows\\\\system32\\\\csrss.exe\",\n             \"?:\\\\Windows\\\\system32\\\\wininit.exe\",\n             \"?:\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe\",\n             \"?:\\\\Windows\\\\system32\\\\MRT.exe\",\n             \"?:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\platform\\\\*\",\n             \"?:\\\\ProgramData\\\\WebEx\\\\webex\\\\*\",\n             \"?:\\\\Windows\\\\LTSvc\\\\LTSVC.exe\") and\n   not winlog.event_data.CallTrace : (\"*mpengine.dll*\", \"*appresolver.dll*\", \"*sysmain.dll*\")\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003/","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001/"}]}],"tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"}}]}}},"__N_SSG":true}