{"pageProps":{"rule":{"metadata":{"creation_date":"2023/04/26","integration":["cloud_defend"],"maturity":"production","updated_date":"2024/05/21"},"rule":{"author":["Elastic"],"description":"This rule detects when chmod is used to add the execute permission to a file inside a container. Modifying file\npermissions to make a file executable could indicate malicious activity, as an attacker may attempt to run unauthorized\nor malicious code inside the container.\n","from":"now-6m","index":["logs-cloud_defend*"],"interval":"5m","language":"eql","license":"Elastic License v2","name":"File Made Executable via Chmod Inside A Container","risk_score":47,"rule_id":"ec604672-bed9-43e1-8871-cf591c052550","severity":"medium","tags":["Data Source: Elastic Defend for Containers","Domain: Container","OS: Linux","Use Case: Threat Detection","Tactic: Execution","Tactic: Defense Evasion","Language: eql"],"timestamp_override":"event.ingested","type":"eql","query":"file where container.id: \"*\" and event.type in (\"change\", \"creation\") and\n\n/*account for tools that execute utilities as a subprocess, in this case the target utility name will appear as a process arg*/\n(process.name : \"chmod\" or process.args : \"chmod\") and \nprocess.args : (\"*x*\", \"777\", \"755\", \"754\", \"700\") and not process.args: \"-x\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/"}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}},{"framework":"MITRE ATT&CK","technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/","subtechnique":[{"id":"T1222.002","name":"Linux and Mac File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/002/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}