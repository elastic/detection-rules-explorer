{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt provides several OSQuery queries that can aid in the detection of reverse/bind shells. Reverse shells are a type of shell in which the target machine communicates back to the attacking machine. Bind shells are a type of shell in which the target machine opens a communication port on the victim machine and waits for an attacker to connect to it. These shells can be used by attackers to gain remote access to a system.\n","integration":["endpoint"],"uuid":"7422faf1-ba51-49c3-b8ba-13759e6bcec4","name":"Persistence Through Reverse/Bind Shells","language":["SQL"],"license":"Elastic License v2","notes":["The hunt provides OSQuery queries to detect reverse/bind shells on Linux systems.","The first hunt query retrieves information about open sockets on the system.","The second hunt query retrieves information about running processes on the system.","The third hunt query retrieves information about listening ports on the system.","Investigate strange or unexpected open sockets, processes, or listening ports on the system.","Use the information from each hunt to pivot and investigate further for potential reverse/bind shells."],"mitre":["T1059.004"],"query":["SELECT (\n  CASE family \n  WHEN 2 THEN 'IP4' \n  WHEN 10 THEN 'IP6' \n  ELSE family END\n) AS family, (\n  CASE protocol \n  WHEN 6 THEN 'TCP' \n  WHEN 17 THEN 'UDP' \n  ELSE protocol END\n) AS protocol, local_address, local_port, \n  remote_address, remote_port \nFROM process_open_sockets \nWHERE family IN (2, 10) \nAND protocol IN (6, 17) \n","SELECT cmdline, name, path, pid, state, threads, total_size \nFROM processes \nWHERE cmdline != ''\n","SELECT pid, address, port, socket, protocol, path FROM listening_ports\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["SELECT (\n  CASE family \n  WHEN 2 THEN 'IP4' \n  WHEN 10 THEN 'IP6' \n  ELSE family END\n) AS family, (\n  CASE protocol \n  WHEN 6 THEN 'TCP' \n  WHEN 17 THEN 'UDP' \n  ELSE protocol END\n) AS protocol, local_address, local_port, \n  remote_address, remote_port \nFROM process_open_sockets \nWHERE family IN (2, 10) \nAND protocol IN (6, 17) \n","SELECT cmdline, name, path, pid, state, threads, total_size \nFROM processes \nWHERE cmdline != ''\n","SELECT pid, address, port, socket, protocol, path FROM listening_ports\n"],"license":"Elastic License v2","description":"This hunt provides several OSQuery queries that can aid in the detection of reverse/bind shells. Reverse shells are a type of shell in which the target machine communicates back to the attacking machine. Bind shells are a type of shell in which the target machine opens a communication port on the victim machine and waits for an attacker to connect to it. These shells can be used by attackers to gain remote access to a system.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1059","name":"","reference":"https://attack.mitre.org/techniques/T1059/","subtechnique":[{"id":"T1059.004","reference":"https://attack.mitre.org/techniques/T1059/004/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint"]}}},"__N_SSG":true}