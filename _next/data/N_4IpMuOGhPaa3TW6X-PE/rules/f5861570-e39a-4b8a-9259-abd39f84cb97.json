{"pageProps":{"rule":{"metadata":{"creation_date":"2023/08/15","integration":["system","windows"],"maturity":"production","updated_date":"2024/10/28","min_stack_version":"8.14.0","min_stack_comments":"Breaking change at 8.14.0 for the Windows Integration."},"rule":{"author":["Elastic"],"building_block_type":"default","description":"Identifies the access on an object with WRITEDAC permissions. With the WRITEDAC permission, the user can perform a Write\nDiscretionary Access Control List (WriteDACL) operation, which is used to modify the access control rules associated\nwith a specific object within Active Directory. Attackers may abuse this privilege to grant themselves or other\ncompromised accounts additional rights, ultimately compromising the target object, resulting in privilege escalation,\nlateral movement, and persistence.\n","from":"now-119m","index":["winlogbeat-*","logs-system.security*","logs-windows.*"],"interval":"60m","language":"kuery","license":"Elastic License v2","name":"WRITEDAC Access on Active Directory Object","references":["https://www.blackhat.com/docs/us-17/wednesday/us-17-Robbins-An-ACE-Up-The-Sleeve-Designing-Active-Directory-DACL-Backdoors.pdf"],"risk_score":21,"rule_id":"f5861570-e39a-4b8a-9259-abd39f84cb97","setup":"## Setup\n\nThe 'Audit Directory Service Access' logging policy must be configured for (Success, Failure).\nSteps to implement the logging policy with Advanced Audit Configuration:\n\n```\nComputer Configuration >\nPolicies >\nWindows Settings >\nSecurity Settings >\nAdvanced Audit Policies Configuration >\nAudit Policies >\nDS Access >\nAudit Directory Service Access (Success,Failure)\n```\n","severity":"low","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Data Source: Active Directory","Use Case: Active Directory Monitoring","Rule Type: BBR","Data Source: System","Language: kuery"],"timestamp_override":"event.ingested","type":"query","query":"host.os.type: \"windows\" and event.action : (\"Directory Service Access\" or \"object-operation-performed\") and\n  event.code : \"4662\" and winlog.event_data.AccessMask:\"0x40000\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/","subtechnique":[{"id":"T1222.001","name":"Windows File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/001/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}