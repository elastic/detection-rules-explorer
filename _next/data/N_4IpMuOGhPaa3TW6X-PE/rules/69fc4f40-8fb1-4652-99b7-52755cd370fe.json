{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt looks for persistence via Launch agent or daemon where the distribution is limited to one unique host.\n","integration":["endpoint"],"uuid":"69fc4f40-8fb1-4652-99b7-52755cd370fe","name":"Low Occurrence of Suspicious Launch Agent or Launch Daemon","language":["ES|QL"],"license":"Elastic License v2","notes":["Further investigation can done pivoting by `Persistence.name` and `args`."],"mitre":["T1547","T1547.011","T1543","T1543.001","T1543.004"],"query":["from logs-endpoint.events.file-*\n| where  @timestamp > now() - 7 day\n| where host.os.family == \"macos\" and event.category == \"file\" and event.action == \"launch_daemon\" and\n  (Persistence.runatload == true or Persistence.keepalive == true) and process.executable is not null\n| eval args = MV_CONCAT(Persistence.args, \",\")\n /* normalizing users home profile */\n| eval args = replace(args, \"\"\"/Users/[a-zA-Z0-9ñ\\.\\-\\_\\$~ ]+/\"\"\", \"/Users/user/\")\n| stats agents = count_distinct(host.id), total = count(*) by process.name, Persistence.name, args\n| where starts_with(args, \"/\") and agents == 1 and total == 1\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["from logs-endpoint.events.file-*\n| where  @timestamp > now() - 7 day\n| where host.os.family == \"macos\" and event.category == \"file\" and event.action == \"launch_daemon\" and\n  (Persistence.runatload == true or Persistence.keepalive == true) and process.executable is not null\n| eval args = MV_CONCAT(Persistence.args, \",\")\n /* normalizing users home profile */\n| eval args = replace(args, \"\"\"/Users/[a-zA-Z0-9ñ\\.\\-\\_\\$~ ]+/\"\"\", \"/Users/user/\")\n| stats agents = count_distinct(host.id), total = count(*) by process.name, Persistence.name, args\n| where starts_with(args, \"/\") and agents == 1 and total == 1\n"],"license":"Elastic License v2","description":"This hunt looks for persistence via Launch agent or daemon where the distribution is limited to one unique host.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1547","name":"","reference":"https://attack.mitre.org/techniques/T1547/"},{"id":"T1547","name":"","reference":"https://attack.mitre.org/techniques/T1547/","subtechnique":[{"id":"T1547.011","reference":"https://attack.mitre.org/techniques/T1547/011/"}]},{"id":"T1543","name":"","reference":"https://attack.mitre.org/techniques/T1543/"},{"id":"T1543","name":"","reference":"https://attack.mitre.org/techniques/T1543/","subtechnique":[{"id":"T1543.001","reference":"https://attack.mitre.org/techniques/T1543/001/"}]},{"id":"T1543","name":"","reference":"https://attack.mitre.org/techniques/T1543/","subtechnique":[{"id":"T1543.004","reference":"https://attack.mitre.org/techniques/T1543/004/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint"]}}},"__N_SSG":true}