{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"Aggregating by paths/hash, this hunt identifies rare instances where a program executes as a child process of the Tasks Scheduler service. This could be the result of persistence as a Windows Scheduled Task.\n","integration":["endpoint","windows"],"uuid":"0d960760-8a40-49c1-bbdd-4deb32c7fd67","name":"Low Frequency of Process Execution via Windows Scheduled Task by Unique Agent","language":["ES|QL"],"license":"Elastic License v2","notes":["Windows security event 4688 lacks `process.parent.command_line` needed for this hunt to identify the Schedule `svchost` instance.","Unique `process.hash.sha256` and agent is not necessarily malicious, however this helps surface signals worth further investigation."],"mitre":["T1053","T1053.005"],"query":["from logs-endpoint.events.process-*, logs-windows.sysmon_operational-*\n| where  @timestamp > now(-) - 7 day\n| where host.os.family == \"windows\" and event.category == \"process\" and\n  event.action in (\"start\", \"Process creation\") and process.code_signature.trusted != true and\n  /* child process of the Tasks Schedule service */\n  process.parent.name == \"svchost.exe\" and ends_with(process.parent.command_line, \"Schedule\")\n| stats hosts = count_distinct(host.id) by process.hash.sha256, process.name\n /* unique hash observed in one unique agent */\n| where hosts == 1\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["from logs-endpoint.events.process-*, logs-windows.sysmon_operational-*\n| where  @timestamp > now(-) - 7 day\n| where host.os.family == \"windows\" and event.category == \"process\" and\n  event.action in (\"start\", \"Process creation\") and process.code_signature.trusted != true and\n  /* child process of the Tasks Schedule service */\n  process.parent.name == \"svchost.exe\" and ends_with(process.parent.command_line, \"Schedule\")\n| stats hosts = count_distinct(host.id) by process.hash.sha256, process.name\n /* unique hash observed in one unique agent */\n| where hosts == 1\n"],"license":"Elastic License v2","description":"Aggregating by paths/hash, this hunt identifies rare instances where a program executes as a child process of the Tasks Scheduler service. This could be the result of persistence as a Windows Scheduled Task.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1053","name":"","reference":"https://attack.mitre.org/techniques/T1053/"},{"id":"T1053","name":"","reference":"https://attack.mitre.org/techniques/T1053/","subtechnique":[{"id":"T1053.005","reference":"https://attack.mitre.org/techniques/T1053/005/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint","windows"]}}},"__N_SSG":true}