{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt identifies SUID binaries on Linux systems using OSQuery. SUID binaries can be exploited by attackers to gain elevated privileges. The hunt includes queries to list all SUID binaries and detailed information about these files, focusing on regular files owned by root with SUID or SGID bits set.\n","integration":["endpoint"],"uuid":"2db642d2-621a-4183-88b5-b2659dc2c940","name":"OSQuery SUID Hunting","language":["SQL"],"license":"Elastic License v2","notes":["Identifies SUID binaries using OSQuery to detect potentially exploitable files with SUID or SGID bits set.","Lists all SUID binaries and provides detailed information about these files, including their paths, owners, and permissions.","Focuses on regular files owned by root with SUID or SGID bits set to identify potential privilege escalation vectors.","OSQuery has limited support for wildcard queries, therefore the query includes multiple LIKE conditions for directories. These can be increased and decreased, based on the environment"],"mitre":["T1548.001","T1574.002"],"query":["SELECT * FROM suid_bin\n","SELECT\n    f.filename,\n    f.path,\n    f.mode,\n    f.uid,\n    f.gid,\n    f.type,\n    u.username AS file_owner,\n    g.groupname AS group_owner,\n    datetime(f.atime, 'unixepoch') AS file_last_access_time,\n    datetime(f.mtime, 'unixepoch') AS file_last_modified_time,\n    datetime(f.ctime, 'unixepoch') AS file_last_status_change_time,\n    datetime(f.btime, 'unixepoch') AS file_created_time,\n    f.size AS size_bytes\nFROM\n    file f\nLEFT JOIN\n    users u ON f.uid = u.uid\nLEFT JOIN\n    groups g ON f.gid = g.gid\nWHERE\nf.type == \"regular\" AND\n(f.uid == 0 or f.gid == 0) AND\n(f.mode LIKE \"2%\" OR f.mode LIKE \"4%\") AND\n(\n  f.path LIKE \"/%%\" OR\n  f.path LIKE \"/%%/%%\" OR\n  f.path LIKE \"/%%/%%/%%\" OR\n  f.path LIKE \"/%%/%%/%%/%%\"\n)\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["SELECT * FROM suid_bin\n","SELECT\n    f.filename,\n    f.path,\n    f.mode,\n    f.uid,\n    f.gid,\n    f.type,\n    u.username AS file_owner,\n    g.groupname AS group_owner,\n    datetime(f.atime, 'unixepoch') AS file_last_access_time,\n    datetime(f.mtime, 'unixepoch') AS file_last_modified_time,\n    datetime(f.ctime, 'unixepoch') AS file_last_status_change_time,\n    datetime(f.btime, 'unixepoch') AS file_created_time,\n    f.size AS size_bytes\nFROM\n    file f\nLEFT JOIN\n    users u ON f.uid = u.uid\nLEFT JOIN\n    groups g ON f.gid = g.gid\nWHERE\nf.type == \"regular\" AND\n(f.uid == 0 or f.gid == 0) AND\n(f.mode LIKE \"2%\" OR f.mode LIKE \"4%\") AND\n(\n  f.path LIKE \"/%%\" OR\n  f.path LIKE \"/%%/%%\" OR\n  f.path LIKE \"/%%/%%/%%\" OR\n  f.path LIKE \"/%%/%%/%%/%%\"\n)\n"],"license":"Elastic License v2","description":"This hunt identifies SUID binaries on Linux systems using OSQuery. SUID binaries can be exploited by attackers to gain elevated privileges. The hunt includes queries to list all SUID binaries and detailed information about these files, focusing on regular files owned by root with SUID or SGID bits set.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1548","name":"","reference":"https://attack.mitre.org/techniques/T1548/","subtechnique":[{"id":"T1548.001","reference":"https://attack.mitre.org/techniques/T1548/001/"}]},{"id":"T1574","name":"","reference":"https://attack.mitre.org/techniques/T1574/","subtechnique":[{"id":"T1574.002","reference":"https://attack.mitre.org/techniques/T1574/002/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint"]}}},"__N_SSG":true}