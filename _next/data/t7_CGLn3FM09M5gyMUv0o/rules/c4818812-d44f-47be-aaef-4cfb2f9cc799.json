{"pageProps":{"rule":{"metadata":{"creation_date":"2021/07/06","integration":["endpoint","windows"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2023/10/23"},"rule":{"author":["Elastic"],"description":"Detects deletion of print driver files by an unusual process. This may indicate a clean up attempt post successful\nprivilege escalation via Print Spooler service related vulnerabilities.\n","false_positives":["    Uninstall or manual deletion of a legitimate printing driver files. Verify the printer file metadata such as\n    manufacturer and signature information.\n    "],"from":"now-9m","index":["winlogbeat-*","logs-endpoint.events.*","logs-windows.*","endgame-*"],"language":"eql","license":"Elastic License v2","name":"Suspicious Print Spooler File Deletion","references":["https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527"],"risk_score":47,"rule_id":"c4818812-d44f-47be-aaef-4cfb2f9cc799","setup":"\nIf enabling an EQL rule on a non-elastic-agent index (such as beats) for versions <8.2,\nevents will not define `event.ingested` and default fallback for EQL rules was not added until version 8.2.\nHence for this rule to work effectively, users will need to add a custom ingest pipeline to populate\n`event.ingested` to @timestamp.\nFor more details on adding a custom ingest pipeline refer - https://www.elastic.co/guide/en/fleet/current/data-streams-pipeline-tutorial.html\n","severity":"medium","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Privilege Escalation","Data Source: Elastic Endgame","Use Case: Vulnerability","Data Source: Elastic Defend"],"timestamp_override":"event.ingested","type":"eql","query":"file where host.os.type == \"windows\" and event.type : \"deletion\" and\n not process.name : (\"spoolsv.exe\", \"dllhost.exe\", \"explorer.exe\") and\n file.path : \"?:\\\\Windows\\\\System32\\\\spool\\\\drivers\\\\x64\\\\3\\\\*.dll\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068/"}],"tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"}}]}}},"__N_SSG":true}