{"pageProps":{"rule":{"metadata":{"creation_date":"2023/08/23","integration":["endpoint","m365_defender","system","crowdstrike"],"maturity":"production","updated_date":"2024/10/31"},"rule":{"author":["Elastic"],"description":"Managed Object Format (MOF) files can be compiled locally or remotely through mofcomp.exe. Attackers may leverage MOF\nfiles to build their own namespaces and classes into the Windows Management Instrumentation (WMI) repository, or\nestablish persistence using WMI Event Subscription.\n","from":"now-9m","index":["logs-endpoint.events.process-*","logs-m365_defender.event-*","endgame-*","logs-system.security-*","logs-crowdstrike.fdr*"],"language":"eql","license":"Elastic License v2","name":"Mofcomp Activity","risk_score":21,"rule_id":"210d4430-b371-470e-b879-80b7182aa75e","severity":"low","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Execution","Data Source: Elastic Defend","Data Source: Microsoft Defender for Endpoint","Data Source: Elastic Endgame","Data Source: System","Data Source: Crowdstrike","Language: eql"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"windows\" and event.type == \"start\" and\n  process.name : \"mofcomp.exe\" and process.args : \"*.mof\" and\n  not user.id : \"S-1-5-18\" and\n  not\n  (\n    process.parent.name : \"ScenarioEngine.exe\" and\n    process.args : (\n      \"*\\\\MSSQL\\\\Binn\\\\*.mof\",\n      \"*\\\\Microsoft SQL Server\\\\???\\\\Shared\\\\*.mof\",\n      \"*\\\\OLAP\\\\bin\\\\*.mof\"\n    )\n  )\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1047","name":"Windows Management Instrumentation","reference":"https://attack.mitre.org/techniques/T1047/"}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}},{"framework":"MITRE ATT&CK","technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546/","subtechnique":[{"id":"T1546.003","name":"Windows Management Instrumentation Event Subscription","reference":"https://attack.mitre.org/techniques/T1546/003/"}]}],"tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"}}]}}},"__N_SSG":true}