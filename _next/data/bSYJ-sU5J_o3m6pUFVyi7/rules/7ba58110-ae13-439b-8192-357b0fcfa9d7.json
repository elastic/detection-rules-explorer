{"pageProps":{"rule":{"metadata":{"creation_date":"2022/06/29","integration":["windows"],"maturity":"production","updated_date":"2024/10/15","min_stack_version":"8.14.0","min_stack_comments":"Breaking change at 8.14.0 for the Windows Integration."},"rule":{"author":["Elastic"],"description":"Identifies suspicious access to LSASS handle from a call trace pointing to seclogon.dll and with a suspicious access\nrights value. This may indicate an attempt to leak an LSASS handle via abusing the Secondary Logon service in\npreparation for credential access.\n","from":"now-9m","index":["winlogbeat-*","logs-windows.sysmon_operational-*"],"language":"eql","license":"Elastic License v2","name":"Suspicious LSASS Access via MalSecLogon","references":["https://splintercod3.blogspot.com/p/the-hidden-side-of-seclogon-part-3.html"],"risk_score":73,"rule_id":"7ba58110-ae13-439b-8192-357b0fcfa9d7","setup":"## Setup\n\nIf enabling an EQL rule on a non-elastic-agent index (such as beats) for versions <8.2,\nevents will not define `event.ingested` and default fallback for EQL rules was not added until version 8.2.\nHence for this rule to work effectively, users will need to add a custom ingest pipeline to populate\n`event.ingested` to @timestamp.\nFor more details on adding a custom ingest pipeline refer - https://www.elastic.co/guide/en/fleet/current/data-streams-pipeline-tutorial.html\n","severity":"high","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Credential Access","Data Source: Sysmon"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"windows\" and event.code == \"10\" and\n  winlog.event_data.TargetImage : \"?:\\\\WINDOWS\\\\system32\\\\lsass.exe\" and\n\n   /* seclogon service accessing lsass */\n  winlog.event_data.CallTrace : \"*seclogon.dll*\" and process.name : \"svchost.exe\" and\n\n   /* PROCESS_CREATE_PROCESS & PROCESS_DUP_HANDLE & PROCESS_QUERY_INFORMATION */\n  winlog.event_data.GrantedAccess == \"0x14c0\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003/","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001/"}]}],"tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"}}]}}},"__N_SSG":true}