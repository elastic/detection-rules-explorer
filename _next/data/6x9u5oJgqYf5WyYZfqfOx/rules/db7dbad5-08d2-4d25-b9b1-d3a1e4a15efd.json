{"pageProps":{"rule":{"metadata":{"creation_date":"2023/01/12","integration":["endpoint","windows"],"maturity":"production","updated_date":"2023/12/21","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0"},"rule":{"author":["Elastic"],"description":"Detects attempts to execute a program on the host from the Windows Subsystem for Linux. \nAdversaries may enable and use WSL for Linux to avoid detection.\n","from":"now-9m","index":["winlogbeat-*","logs-endpoint.events.*","logs-windows.*","endgame-*"],"language":"eql","license":"Elastic License v2","name":"Execution via Windows Subsystem for Linux","references":["https://learn.microsoft.com/en-us/windows/wsl/wsl-config"],"risk_score":47,"rule_id":"db7dbad5-08d2-4d25-b9b1-d3a1e4a15efd","severity":"medium","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Data Source: Elastic Endgame","Data Source: Elastic Defend"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"windows\" and event.type : \"start\" and\n  process.parent.name : (\"wsl.exe\", \"wslhost.exe\") and\n  not process.executable : (\n        \"?:\\\\Program Files (x86)\\\\*\",\n        \"?:\\\\Program Files\\\\*\",\n        \"?:\\\\Program Files*\\\\WindowsApps\\\\MicrosoftCorporationII.WindowsSubsystemForLinux_*\\\\wsl*.exe\",\n        \"?:\\\\Windows\\\\System32\\\\conhost.exe\",\n        \"?:\\\\Windows\\\\System32\\\\lxss\\\\wslhost.exe\",\n        \"?:\\\\Windows\\\\System32\\\\WerFault.exe\",\n        \"?:\\\\Windows\\\\Sys*\\\\wslconfig.exe\"\n  )\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1202","name":"Indirect Command Execution","reference":"https://attack.mitre.org/techniques/T1202/"}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}