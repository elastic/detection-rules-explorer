{"pageProps":{"rule":{"metadata":{"creation_date":"2021/10/05","integration":["endpoint"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2023/10/23"},"rule":{"author":["Elastic"],"description":"Identifies when a child process is spawned by the screensaver engine process, which is consistent with an attacker's\nmalicious payload being executed after the screensaver activated on the endpoint. An adversary can maintain persistence\non a macOS endpoint by creating a malicious screensaver (.saver) file and configuring the screensaver plist file to\nexecute code each time the screensaver is activated.\n","from":"now-9m","index":["auditbeat-*","logs-endpoint.events.*"],"language":"eql","license":"Elastic License v2","name":"Unexpected Child Process of macOS Screensaver Engine","note":"## Triage and analysis\n\n- Analyze the descendant processes of the ScreenSaverEngine process for malicious code and suspicious behavior such\nas a download of a payload from a server.\n- Review the installed and activated screensaver on the host. Triage the screensaver (.saver) file that was triggered to\nidentify whether the file is malicious or not.\n\n","references":["https://posts.specterops.io/saving-your-access-d562bf5bf90b","https://github.com/D00MFist/PersistentJXA"],"risk_score":47,"rule_id":"48d7f54d-c29e-4430-93a9-9db6b5892270","setup":"\nIf enabling an EQL rule on a non-elastic-agent index (such as beats) for versions <8.2,\nevents will not define `event.ingested` and default fallback for EQL rules was not added until version 8.2.\nHence for this rule to work effectively, users will need to add a custom ingest pipeline to populate\n`event.ingested` to @timestamp.\nFor more details on adding a custom ingest pipeline refer - https://www.elastic.co/guide/en/fleet/current/data-streams-pipeline-tutorial.html\n\n","severity":"medium","tags":["Domain: Endpoint","OS: macOS","Use Case: Threat Detection","Tactic: Persistence","Data Source: Elastic Defend"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"macos\" and event.type == \"start\" and process.parent.name == \"ScreenSaverEngine\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546/","subtechnique":[{"id":"T1546.002","name":"Screensaver","reference":"https://attack.mitre.org/techniques/T1546/002/"}]}],"tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"}}]}}},"__N_SSG":true}