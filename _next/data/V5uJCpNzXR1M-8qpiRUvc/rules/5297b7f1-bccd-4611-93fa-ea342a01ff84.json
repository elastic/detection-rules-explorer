{"pageProps":{"rule":{"metadata":{"creation_date":"2023/09/25","integration":["endpoint"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2023/09/25"},"rule":{"author":["Elastic"],"description":"Identifies the execution of DotNet ClickOnce installer via Dfsvc.exe trampoline. Adversaries may take advantage of\nClickOnce to proxy execution of malicious payloads via trusted Microsoft processes.\n","from":"now-119m","interval":"60m","index":["logs-endpoint.events.*"],"language":"eql","license":"Elastic License v2","name":"Execution via Microsoft DotNet ClickOnce Host","risk_score":21,"rule_id":"5297b7f1-bccd-4611-93fa-ea342a01ff84","severity":"low","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Rule Type: BBR","Data Source: Elastic Defend"],"building_block_type":"default","type":"eql","query":"sequence by user.id with maxspan=5s\n [process where host.os.type == \"windows\" and event.action == \"start\" and\n  process.name : \"rundll32.exe\" and process.command_line : (\"*dfshim*ShOpenVerbApplication*\", \"*dfshim*#*\")]\n [network where host.os.type == \"windows\" and process.name : \"dfsvc.exe\"]\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1127","name":"Trusted Developer Utilities Proxy Execution","reference":"https://attack.mitre.org/techniques/T1127/"},{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218/","subtechnique":[{"id":"T1218.011","name":"Rundll32","reference":"https://attack.mitre.org/techniques/T1218/011/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}