{"pageProps":{"rule":{"metadata":{"creation_date":"2021/01/20","integration":["endpoint"],"maturity":"production","updated_date":"2024/08/07"},"rule":{"author":["Elastic"],"description":"Identifies modifications to the registered Subject Interface Package (SIP) providers. SIP providers are used by the\nWindows cryptographic system to validate file signatures on the system. This may be an attempt to bypass signature\nvalidation checks or inject code into critical processes.\n","from":"now-9m","index":["logs-endpoint.events.registry-*","endgame-*","logs-windows.sysmon_operational-*","winlogbeat-*"],"language":"eql","license":"Elastic License v2","name":"SIP Provider Modification","references":["https://github.com/mattifestation/PoCSubjectInterfacePackage"],"risk_score":47,"rule_id":"f2c7b914-eda3-40c2-96ac-d23ef91776ca","severity":"medium","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Data Source: Elastic Endgame","Data Source: Elastic Defend","Data Source: Sysmon"],"timestamp_override":"event.ingested","type":"eql","query":"registry where host.os.type == \"windows\" and event.type == \"change\" and registry.value : (\"Dll\", \"$Dll\") and\n  registry.path: (\n    \"*\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CryptSIPDllPutSignedDataMsg\\\\{*}\\\\Dll\",\n    \"*\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CryptSIPDllPutSignedDataMsg\\\\{*}\\\\Dll\",\n    \"*\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\Providers\\\\Trust\\\\FinalPolicy\\\\{*}\\\\$Dll\",\n    \"*\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Cryptography\\\\Providers\\\\Trust\\\\FinalPolicy\\\\{*}\\\\$Dll\"\n    ) and\n  registry.data.strings:\"*.dll\" and\n  not (process.name : \"msiexec.exe\" and registry.data.strings : \"mso.dll\") and\n  not (process.name : \"regsvr32.exe\" and registry.data.strings == \"WINTRUST.DLL\")\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1553","name":"Subvert Trust Controls","reference":"https://attack.mitre.org/techniques/T1553/","subtechnique":[{"id":"T1553.003","name":"SIP and Trust Provider Hijacking","reference":"https://attack.mitre.org/techniques/T1553/003/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}