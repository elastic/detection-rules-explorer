{"pageProps":{"rule":{"metadata":{"creation_date":"2023/09/22","integration":["beaconing","endpoint","network_traffic"],"maturity":"production","updated_date":"2024/11/07"},"rule":{"author":["Elastic"],"description":"A statistical model has identified command-and-control (C2) beaconing activity with high confidence. Beaconing can help\nattackers maintain stealthy communication with their C2 servers, receive instructions and payloads, exfiltrate data and\nmaintain persistence in a network.\n","from":"now-1h","index":["ml_beaconing.all"],"language":"kuery","license":"Elastic License v2","name":"Statistical Model Detected C2 Beaconing Activity with High Confidence","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html","https://docs.elastic.co/en/integrations/beaconing","https://www.elastic.co/security-labs/identifying-beaconing-malware-using-elastic"],"risk_score":21,"rule_id":"0ab319ef-92b8-4c7f-989b-5de93c852e93","setup":"## Setup\n\nThe rule requires the Network Beaconing Identification integration assets to be installed, as well as network logs collected by the Elastic Defend or Network Packet Capture integrations.\n\n### Network Beaconing Identification Setup\nThe Network Beaconing Identification integration consists of a statistical framework to identify C2 beaconing activity in network logs.\n\n#### Prerequisite Requirements:\n- Fleet is required for Network Beaconing Identification.\n- To configure Fleet Server refer to the [documentation](https://www.elastic.co/guide/en/fleet/current/fleet-server.html).\n- Network events collected by the [Elastic Defend](https://docs.elastic.co/en/integrations/endpoint) or [Network Packet Capture](https://docs.elastic.co/integrations/network_traffic) integration.\n- To install Elastic Defend, refer to the [documentation](https://www.elastic.co/guide/en/security/current/install-endpoint.html).\n- To add the Network Packet Capture integration to an Elastic Agent policy, refer to [this](https://www.elastic.co/guide/en/fleet/current/add-integration-to-policy.html) guide.\n\n#### The following steps should be executed to install assets associated with the Network Beaconing Identification integration:\n- Go to the Kibana homepage. Under Management, click Integrations.\n- In the query bar, search for Network Beaconing Identification and select the integration to see more details about it.\n- Follow the instructions under the **Installation** section.\n","severity":"low","tags":["Domain: Network","Use Case: C2 Beaconing Detection","Tactic: Command and Control","Language: kuery"],"timestamp_override":"event.ingested","type":"query","query":"beacon_stats.beaconing_score: 3\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1102","name":"Web Service","reference":"https://attack.mitre.org/techniques/T1102/","subtechnique":[{"id":"T1102.002","name":"Bidirectional Communication","reference":"https://attack.mitre.org/techniques/T1102/002/"}]}],"tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011/"}}]}}},"__N_SSG":true}