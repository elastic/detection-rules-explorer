{"pageProps":{"rule":{"metadata":{"creation_date":"2024/09/04","integration":["o365"],"maturity":"production","updated_date":"2024/09/25"},"rule":{"author":["Elastic"],"description":"Detects successful Microsoft 365 portal logins from impossible travel locations. Impossible travel locations are defined\nas two different countries within a short time frame. This behavior may indicate an adversary attempting to access a\nMicrosoft 365 account from a compromised account or a malicious actor attempting to access a Microsoft 365 account from\na different location.\n","false_positives":["    False positives may occur when users are using a VPN or when users are traveling to different locations for\n    legitimate purposes.\n    "],"from":"now-15m","index":["filebeat-*","logs-o365.audit-*"],"language":"kuery","license":"Elastic License v2","name":"Microsoft 365 Portal Logins from Impossible Travel Locations","references":["https://www.huntress.com/blog/time-travelers-busted-how-to-detect-impossible-travel-"],"risk_score":47,"rule_id":"3896d4c0-6ad1-11ef-8c7b-f661ea17fbcc","severity":"medium","tags":["Domain: Cloud","Data Source: Microsoft 365","Use Case: Threat Detection","Tactic: Initial Access"],"timestamp_override":"event.ingested","type":"threshold","query":"event.dataset: \"o365.audit\"\n    and event.provider: \"AzureActiveDirectory\"\n    and event.action: \"UserLoggedIn\"\n    and event.outcome: \"success\"\n    and not o365.audit.UserId: \"Not Available\"\n    and o365.audit.Target.Type: (\"0\" or \"2\" or \"3\" or \"5\" or \"6\" or \"10\")\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/","subtechnique":[{"id":"T1078.004","name":"Cloud Accounts","reference":"https://attack.mitre.org/techniques/T1078/004/"}]}],"tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"}}],"threshold":{"field":["o365.audit.UserId"],"value":1,"cardinality":[{"field":"source.geo.country_name","value":2}]}}}},"__N_SSG":true}