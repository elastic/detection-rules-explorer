{"pageProps":{"rule":{"metadata":{"creation_date":"2020/09/02","integration":["endpoint","windows"],"maturity":"production","updated_date":"2024/09/23"},"rule":{"author":["Elastic"],"description":"Identifies Mshta.exe making outbound network connections. This may indicate adversarial activity, as Mshta is often\nleveraged by adversaries to execute malicious scripts and evade detection.\n","from":"now-20m","index":["logs-endpoint.events.process-*","logs-endpoint.events.network-*","winlogbeat-*","logs-windows.sysmon_operational-*"],"language":"eql","license":"Elastic License v2","name":"Mshta Making Network Connections","references":["https://www.elastic.co/security-labs/elastic-protects-against-data-wiper-malware-targeting-ukraine-hermeticwiper"],"risk_score":47,"rule_id":"c2d90150-0133-451c-a783-533e736c12d7","severity":"medium","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Data Source: Elastic Defend","Data Source: Sysmon"],"type":"eql","query":"sequence by process.entity_id with maxspan=10m\n  [process where host.os.type == \"windows\" and event.type == \"start\" and process.name : \"mshta.exe\" and\n     not process.parent.name : \"Microsoft.ConfigurationManagement.exe\" and\n     not (process.parent.executable : \"C:\\\\Amazon\\\\Amazon Assistant\\\\amazonAssistantService.exe\" or\n          process.parent.executable : \"C:\\\\TeamViewer\\\\TeamViewer.exe\") and\n     not process.args : \"ADSelfService_Enroll.hta\"]\n  [network where host.os.type == \"windows\" and process.name : \"mshta.exe\"]\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218/","subtechnique":[{"id":"T1218.005","name":"Mshta","reference":"https://attack.mitre.org/techniques/T1218/005/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}}]}}},"__N_SSG":true}