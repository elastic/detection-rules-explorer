{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt identifies low volume modifications to critical system binaries on Linux systems. It monitors file modification events in critical directories such as /bin, /usr/bin, /sbin, and /usr/sbin. The hunt focuses on modifications made by unique hosts, excluding expected update processes like package managers. This can help detect unauthorized or suspicious modifications to system binaries.\n","integration":["endpoint"],"uuid":"c7044817-d9a5-4755-abab-9059e50dab24","name":"Low Volume Modifications to Critical System Binaries by Unique Host","language":["ES|QL"],"license":"Elastic License v2","notes":["Monitors for file modifications in critical directories like /bin, /usr/bin, /sbin, and /usr/sbin.","Excludes modifications made by expected update processes such as package managers to reduce false positives.","Counts the number of unique files modified by each host and the number of modifications made.","Focuses on modifications made by unique hosts to detect unauthorized or suspicious changes."],"mitre":["T1070.004","T1569.002"],"query":["from logs-endpoint.events.file-*\n| where @timestamp > now() - 7 day\n| where host.os.type == \"linux\" and\n  (file.path like \"/bin/*\" or file.path like \"/usr/bin/*\" or file.path like \"/sbin/*\" or file.path like \"/usr/sbin/*\") and\n  not (\n\n  // Exclude expected update processes, e.g., package managers\n  process.executable in (\"/usr/bin/apt\", \"/usr/bin/dpkg\", \"/usr/bin/yum\", \"/usr/bin/rpm\", \"/usr/bin/pacman\",\n  \"/usr/bin/pamac-daemon\", \"/usr/bin/update-alternatives\", \"/usr/bin/dockerd\", \"/usr/bin/microdnf\", \"/sbin/apk\") or\n\n  // Exclude certain benign or expected modification patterns, if applicable\n  file.path like \"/usr/bin/gzip*\" // Example exclusion, adjust based on your environment\n)\n| stats modification_count = count(file.path), unique_files_modified = count_distinct(file.path), host_count = count_distinct(host.name) by process.executable\n| where modification_count >= 1 and host_count == 1\n| sort modification_count asc\n| limit 100\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["from logs-endpoint.events.file-*\n| where @timestamp > now() - 7 day\n| where host.os.type == \"linux\" and\n  (file.path like \"/bin/*\" or file.path like \"/usr/bin/*\" or file.path like \"/sbin/*\" or file.path like \"/usr/sbin/*\") and\n  not (\n\n  // Exclude expected update processes, e.g., package managers\n  process.executable in (\"/usr/bin/apt\", \"/usr/bin/dpkg\", \"/usr/bin/yum\", \"/usr/bin/rpm\", \"/usr/bin/pacman\",\n  \"/usr/bin/pamac-daemon\", \"/usr/bin/update-alternatives\", \"/usr/bin/dockerd\", \"/usr/bin/microdnf\", \"/sbin/apk\") or\n\n  // Exclude certain benign or expected modification patterns, if applicable\n  file.path like \"/usr/bin/gzip*\" // Example exclusion, adjust based on your environment\n)\n| stats modification_count = count(file.path), unique_files_modified = count_distinct(file.path), host_count = count_distinct(host.name) by process.executable\n| where modification_count >= 1 and host_count == 1\n| sort modification_count asc\n| limit 100\n"],"license":"Elastic License v2","description":"This hunt identifies low volume modifications to critical system binaries on Linux systems. It monitors file modification events in critical directories such as /bin, /usr/bin, /sbin, and /usr/sbin. The hunt focuses on modifications made by unique hosts, excluding expected update processes like package managers. This can help detect unauthorized or suspicious modifications to system binaries.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1070","name":"","reference":"https://attack.mitre.org/techniques/T1070/","subtechnique":[{"id":"T1070.004","reference":"https://attack.mitre.org/techniques/T1070/004/"}]},{"id":"T1569","name":"","reference":"https://attack.mitre.org/techniques/T1569/","subtechnique":[{"id":"T1569.002","reference":"https://attack.mitre.org/techniques/T1569/002/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint"]}}},"__N_SSG":true}