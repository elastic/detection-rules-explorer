{"pageProps":{"rule":{"metadata":{"creation_date":"2020/03/25","integration":["endpoint","windows"],"maturity":"production","updated_date":"2024/10/28","min_stack_version":"8.14.0","min_stack_comments":"Breaking change at 8.14.0 for the Windows Integration."},"rule":{"author":["Elastic"],"description":"An instance of MSBuild, the Microsoft Build Engine, was started by a script or the Windows command interpreter. This\nbehavior is unusual and is sometimes used by malicious payloads.\n","false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-9m","index":["winlogbeat-*","logs-endpoint.events.process-*","logs-windows.*"],"language":"kuery","license":"Elastic License v2","name":"Microsoft Build Engine Started by a Script Process","risk_score":21,"rule_id":"9d110cb3-5f4b-4c9a-b9f5-53f0a1707ae2","setup":"## Setup\n\nIf enabling an EQL rule on a non-elastic-agent index (such as beats) for versions <8.2,\nevents will not define `event.ingested` and default fallback for EQL rules was not added until version 8.2.\nHence for this rule to work effectively, users will need to add a custom ingest pipeline to populate\n`event.ingested` to @timestamp.\nFor more details on adding a custom ingest pipeline refer - https://www.elastic.co/guide/en/fleet/current/data-streams-pipeline-tutorial.html\n","severity":"low","tags":["Domain: Endpoint","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Tactic: Execution","Data Source: Elastic Defend"],"timestamp_override":"event.ingested","type":"new_terms","query":"host.os.type:windows and event.category:process and event.type:start and (\n  process.name.caseless:\"msbuild.exe\" or process.pe.original_file_name:\"MSBuild.exe\") and \n  process.parent.name:(\"cmd.exe\" or \"powershell.exe\" or \"pwsh.exe\" or \"powershell_ise.exe\" or \"cscript.exe\" or\n    \"wscript.exe\" or \"mshta.exe\")\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1127","name":"Trusted Developer Utilities Proxy Execution","reference":"https://attack.mitre.org/techniques/T1127/","subtechnique":[{"id":"T1127.001","name":"MSBuild","reference":"https://attack.mitre.org/techniques/T1127/001/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}},{"framework":"MITRE ATT&CK","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001/"},{"id":"T1059.003","name":"Windows Command Shell","reference":"https://attack.mitre.org/techniques/T1059/003/"},{"id":"T1059.005","name":"Visual Basic","reference":"https://attack.mitre.org/techniques/T1059/005/"}]}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}}],"new_terms":{"field":"new_terms_fields","value":["host.id","user.name","process.command_line"],"history_window_start":[{"field":"history_window_start","value":"now-14d"}]}}}},"__N_SSG":true}