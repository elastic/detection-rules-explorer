{"pageProps":{"rule":{"metadata":{"creation_date":"2023/04/26","integration":["cloud_defend"],"maturity":"production","updated_date":"2024/05/21"},"rule":{"author":["Elastic"],"description":"This rule detects when an interactive shell is spawned inside a running container. This could indicate a potential\ncontainer breakout attempt or an attacker's attempt to gain unauthorized access to the underlying host.\n","false_positives":["    Legitimate users and processes, such as system administration tools, may utilize shell utilities inside a container\n    resulting in false positives.\n    "],"from":"now-6m","index":["logs-cloud_defend*"],"interval":"5m","language":"eql","license":"Elastic License v2","name":"Suspicious Interactive Shell Spawned From Inside A Container","risk_score":73,"rule_id":"8d3d0794-c776-476b-8674-ee2e685f6470","severity":"high","tags":["Data Source: Elastic Defend for Containers","Domain: Container","OS: Linux","Use Case: Threat Detection","Tactic: Execution"],"timestamp_override":"event.ingested","type":"eql","query":"process where container.id: \"*\" and\nevent.type== \"start\" and \n\n/*D4C consolidates closely spawned event.actions, this excludes end actions to only capture ongoing processes*/\nevent.action in (\"fork\", \"exec\") and event.action != \"end\"\n and process.entry_leader.same_as_process== false and\n(\n(process.executable: \"*/*sh\" and process.args: (\"-i\", \"-it\")) or\nprocess.args: \"*/*sh\"\n)\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004/"}]}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}}]}}},"__N_SSG":true}