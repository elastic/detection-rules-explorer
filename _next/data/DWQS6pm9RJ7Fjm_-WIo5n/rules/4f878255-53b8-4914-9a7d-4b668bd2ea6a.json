{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt attempts to identify remote process injection by aggregating Sysmon `CreateRemoteThread` events by source process and returns the ones that we observed in only one unique host.","integration":["windows"],"uuid":"4f878255-53b8-4914-9a7d-4b668bd2ea6a","name":"Low Occurrence Rate of CreateRemoteThread by Source Process","language":["ES|QL"],"license":"Elastic License v2","notes":["Adding `winlog.event_data.TargetImage` to the aggregation clause can be beneficial but may introduce more false-positives."],"mitre":["T1055"],"query":["from logs-windows.sysmon_operational-*\n| where @timestamp > now() - 7 day\n| where host.os.family == \"windows\" and event.category == \"process\" and event.action == \"CreateRemoteThread\"\n| eval source_process = replace(process.executable, \"\"\"[cC]:\\\\[uU][sS][eE][rR][sS]\\\\[a-zA-Z0-9ñ\\.\\-\\_\\$~ ]+\\\\\"\"\", \"C:\\\\\\\\users\\\\\\\\user\\\\\\\\\")\n| stats cc = count(*), hosts = count_distinct(host.id) by source_process\n /* unique source and target processes combined and observed in 1 host */\n| where hosts == 1 and cc == 1\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["from logs-windows.sysmon_operational-*\n| where @timestamp > now() - 7 day\n| where host.os.family == \"windows\" and event.category == \"process\" and event.action == \"CreateRemoteThread\"\n| eval source_process = replace(process.executable, \"\"\"[cC]:\\\\[uU][sS][eE][rR][sS]\\\\[a-zA-Z0-9ñ\\.\\-\\_\\$~ ]+\\\\\"\"\", \"C:\\\\\\\\users\\\\\\\\user\\\\\\\\\")\n| stats cc = count(*), hosts = count_distinct(host.id) by source_process\n /* unique source and target processes combined and observed in 1 host */\n| where hosts == 1 and cc == 1\n"],"license":"Elastic License v2","description":"This hunt attempts to identify remote process injection by aggregating Sysmon `CreateRemoteThread` events by source process and returns the ones that we observed in only one unique host.","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1055","name":"","reference":"https://attack.mitre.org/techniques/T1055/"}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["windows"]}}},"__N_SSG":true}