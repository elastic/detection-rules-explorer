{"pageProps":{"rule":{"metadata":{"creation_date":"2021/07/15","integration":["o365"],"maturity":"development","updated_date":"2024/09/05"},"rule":{"author":["Austin Songer"],"description":"Identifies when a Microsoft Cloud App Security reported a risky sign-in attempt due to a login associated with an\nimpossible travel.\n","false_positives":["User using a VPN may lead to false positives."],"from":"now-30m","index":["filebeat-*","logs-o365*"],"language":"kuery","license":"Elastic License v2","name":"Microsoft 365 Impossible travel activity","note":"## Important\n\nThis rule is no longer applicable based on changes to Microsoft Defender for Office 365. Please refer to the following rules for similar detections:\n\n- Microsoft 365 Portal Logins from Impossible Travel Locations (3896d4c0-6ad1-11ef-8c7b-f661ea17fbcc)\n- Microsoft 365 Portal Login from Rare Location (32d3ad0e-6add-11ef-8c7b-f661ea17fbcc)\n\nReference: https://learn.microsoft.com/en-us/defender-cloud-apps/cloud-discovery-anomaly-detection-policy\n","setup":"## Setup\n\nThe Office 365 Logs Fleet integration, Filebeat module, or similarly structured data is required to be compatible with this rule.\n","references":["https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy","https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference"],"risk_score":47,"rule_id":"9c49fe22-4e86-4384-a9a0-602f4d54088d","severity":"medium","tags":["Domain: Cloud","Data Source: Microsoft 365","Use Case: Configuration Audit","Tactic: Initial Access"],"timestamp_override":"event.ingested","type":"query","query":"event.dataset:o365.audit and event.provider:SecurityComplianceCenter and event.category:web and event.action:\"Impossible travel activity\" and event.outcome:success\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}],"tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"}}]}}},"__N_SSG":true}