{"pageProps":{"rule":{"metadata":{"creation_date":"2023/08/30","integration":["endpoint"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2024/03/08"},"rule":{"author":["Elastic"],"description":"This rule monitors for the usage of the which command with an unusual amount of process arguments. Attackers may leverage\nthe which command to enumerate the system for useful installed utilities that may be used after compromising a system to\nescalate privileges or move latteraly across the network. \n","from":"now-9m","index":["logs-endpoint.events.*","endgame-*"],"language":"eql","license":"Elastic License v2","name":"Suspicious which Enumeration","risk_score":21,"rule_id":"5b18eef4-842c-4b47-970f-f08d24004bde","severity":"low","tags":["Domain: Endpoint","OS: Linux","Use Case: Threat Detection","Tactic: Discovery","Data Source: Elastic Defend","Data Source: Elastic Endgame"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"linux\" and event.type == \"start\" and event.action in (\"exec\", \"exec_event\") and \nprocess.name == \"which\" and process.args_count >= 10 and not process.parent.name == \"jem\" and \nnot process.args == \"--tty-only\"\n\n/* potential tuning if rule would turn out to be noisy\nand process.args in (\"nmap\", \"nc\", \"ncat\", \"netcat\", nc.traditional\", \"gcc\", \"g++\", \"socat\") and \nprocess.parent.name in (\"bash\", \"dash\", \"ash\", \"sh\", \"tcsh\", \"csh\", \"zsh\", \"ksh\", \"fish\")\n*/ \n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082/"}],"tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"}}]}}},"__N_SSG":true}