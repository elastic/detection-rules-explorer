{"pageProps":{"rule":{"hunt":{"author":"Elastic","description":"This hunt identifies drivers loaded with low occurrence frequency on Linux systems. It monitors for the loading of kernel modules (drivers) that have only been seen once across a single host within a year. Such activity can indicate the presence of rare or potentially malicious drivers.\n","integration":["endpoint"],"uuid":"e1f59c9a-7a2a-4eb8-a524-97b16a041a4a","name":"Drivers Load with Low Occurrence Frequency","language":["ES|QL"],"license":"Elastic License v2","notes":["Monitors for kernel modules loaded with syscall 'init_module' or 'finit_module', indicating driver load events.","Counts the occurrence of each driver across all hosts and identifies those seen only once on a single host within the past year.","Such rare driver loads can indicate potentially malicious activity or the presence of uncommon drivers."],"mitre":["T1547.006","T1069.002"],"query":["from logs-auditd_manager.auditd-*, logs-auditd.log-*, auditbeat-*\n| keep @timestamp, host.os.type, event.category, event.action, auditd.data.syscall, auditd.data.name, process.executable, process.name, agent.id\n| where @timestamp > now() - 30 day\n| where host.os.type == \"linux\" and event.category == \"driver\" and event.action == \"loaded-kernel-module\" and auditd.data.syscall in (\"init_module\", \"finit_module\")\n// Process name is different from executable in some cases\n| stats agent_count = count_distinct(agent.id), total_count = count(*) by auditd.data.name, process.executable, process.name\n// Alter this threshold to make sense for your environment\n| where agent_count == 1 and total_count <= 3\n| limit 100\n| sort auditd.data.name asc\n"]},"rule":{"tags":["Hunt Type: Hunt"],"query":["from logs-auditd_manager.auditd-*, logs-auditd.log-*, auditbeat-*\n| keep @timestamp, host.os.type, event.category, event.action, auditd.data.syscall, auditd.data.name, process.executable, process.name, agent.id\n| where @timestamp > now() - 30 day\n| where host.os.type == \"linux\" and event.category == \"driver\" and event.action == \"loaded-kernel-module\" and auditd.data.syscall in (\"init_module\", \"finit_module\")\n// Process name is different from executable in some cases\n| stats agent_count = count_distinct(agent.id), total_count = count(*) by auditd.data.name, process.executable, process.name\n// Alter this threshold to make sense for your environment\n| where agent_count == 1 and total_count <= 3\n| limit 100\n| sort auditd.data.name asc\n"],"license":"Elastic License v2","description":"This hunt identifies drivers loaded with low occurrence frequency on Linux systems. It monitors for the loading of kernel modules (drivers) that have only been seen once across a single host within a year. Such activity can indicate the presence of rare or potentially malicious drivers.\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"","name":"","reference":""},"technique":[{"id":"T1547","name":"","reference":"https://attack.mitre.org/techniques/T1547/","subtechnique":[{"id":"T1547.006","reference":"https://attack.mitre.org/techniques/T1547/006/"}]},{"id":"T1069","name":"","reference":"https://attack.mitre.org/techniques/T1069/","subtechnique":[{"id":"T1069.002","reference":"https://attack.mitre.org/techniques/T1069/002/"}]}]}]},"metadata":{"creation_date":"1970-01-01T00:00:00.000Z","updated_date":"1970-01-01T00:00:00.000Z","integration":["endpoint"]}}},"__N_SSG":true}