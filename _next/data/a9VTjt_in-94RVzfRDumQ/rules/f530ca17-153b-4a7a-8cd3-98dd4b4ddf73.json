{"pageProps":{"rule":{"metadata":{"creation_date":"2023/06/26","integration":["endpoint"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2023/06/26"},"rule":{"author":["Elastic"],"description":"Identifies when the openssl command-line utility is used to encrypt multiple files on a host within a short time window.\nAdversaries may encrypt data on a single or multiple systems in order to disrupt the availability of their target's data\nand may attempt to hold the organization's data to ransom for the purposes of extortion.\n","from":"now-9m","index":["logs-endpoint.events.*"],"language":"eql","license":"Elastic License v2","name":"Suspicious Data Encryption via OpenSSL Utility","references":["https://www.welivesecurity.com/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/","https://www.trendmicro.com/en_us/research/21/f/bash-ransomware-darkradiation-targets-red-hat--and-debian-based-linux-distributions.html"],"risk_score":47,"rule_id":"f530ca17-153b-4a7a-8cd3-98dd4b4ddf73","severity":"medium","tags":["Domain: Endpoint","OS: Linux","Use Case: Threat Detection","Tactic: Impact","Data Source: Elastic Defend"],"type":"eql","query":"sequence by host.id, user.name, process.parent.entity_id with maxspan=5s\n  [ process where host.os.type == \"linux\" and event.action == \"exec\" and \n    process.name == \"openssl\" and process.parent.name : (\"bash\", \"dash\", \"sh\", \"tcsh\", \"csh\", \"zsh\", \"ksh\", \"fish\", \"perl*\", \"php*\", \"python*\", \"xargs\") and\n    process.args == \"-in\" and process.args == \"-out\" and\n    process.args in (\"-k\", \"-K\", \"-kfile\", \"-pass\", \"-iv\", \"-md\") and\n    /* excluding base64 encoding options and including encryption password or key params */\n    not process.args in (\"-d\", \"-a\", \"-A\", \"-base64\", \"-none\", \"-nosalt\") ] with runs=10\n","threat":[{"framework":"MITRE ATT&CK","tactic":{"name":"Impact","id":"TA0040","reference":"https://attack.mitre.org/tactics/TA0040/"},"technique":[{"name":"Data Encrypted for Impact","id":"T1486","reference":"https://attack.mitre.org/techniques/T1486/"}]}]}}},"__N_SSG":true}