{"pageProps":{"rule":{"metadata":{"creation_date":"2023/10/26","integration":["cloud_defend"],"maturity":"production","updated_date":"2024/05/21"},"rule":{"author":["Elastic"],"description":"This rule detects modification of the CGroup release_agent file from inside a privileged container. The release_agent is\na script that is executed at the termination of any process on that CGroup and is invoked from the host. A privileged\ncontainer with SYS_ADMIN capabilities, enables a threat actor to mount a CGroup directory and modify the release_agent\nwhich could be used for further privilege escalation and container escapes to the host machine.\n","from":"now-6m","index":["logs-cloud_defend*"],"interval":"5m","language":"eql","license":"Elastic License v2","name":"Potential Container Escape via Modified release_agent File","references":["https://blog.aquasec.com/threat-alert-container-escape","https://sysdig.com/blog/detecting-mitigating-cve-2022-0492-sysdig/","https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation#privileged-escape-abusing-existent-release_agent-cve-2022-0492-poc1"],"risk_score":47,"rule_id":"160896de-b66f-42cb-8fef-20f53a9006ea","severity":"medium","tags":["Data Source: Elastic Defend for Containers","Domain: Container","OS: Linux","Use Case: Threat Detection","Tactic: Privilege Escalation"],"timestamp_override":"event.ingested","type":"eql","query":"file where event.module == \"cloud_defend\" and event.action == \"open\" and \nevent.type == \"change\" and file.name : \"release_agent\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1611","name":"Escape to Host","reference":"https://attack.mitre.org/techniques/T1611/"}],"tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"}}]}}},"__N_SSG":true}