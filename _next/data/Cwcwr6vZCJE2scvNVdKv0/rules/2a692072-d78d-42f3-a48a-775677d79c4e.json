{"pageProps":{"rule":{"metadata":{"creation_date":"2022/06/20","integration":["endpoint"],"maturity":"production","min_stack_comments":"New fields added: required_fields, related_integrations, setup","min_stack_version":"8.3.0","updated_date":"2023/07/31"},"rule":{"author":["Elastic"],"description":"This rule monitors for suspicious activities that may indicate an attacker attempting to execute arbitrary code within \na PostgreSQL environment. Attackers can execute code via PostgreSQL as a result of gaining unauthorized access to a\npublic facing PostgreSQL database or exploiting vulnerabilities, such as remote command execution and SQL injection\nattacks, which can result in unauthorized access and malicious actions, and facilitate post-exploitation activities\nfor unauthorized access and malicious actions.\n","from":"now-9m","index":["logs-endpoint.events.*","endgame-*"],"language":"eql","license":"Elastic License v2","name":"Potential Code Execution via Postgresql","risk_score":47,"rule_id":"2a692072-d78d-42f3-a48a-775677d79c4e","severity":"medium","tags":["Domain: Endpoint","OS: Linux","Use Case: Threat Detection","Tactic: Execution","Data Source: Elastic Endgame"],"type":"eql","query":"process where host.os.type == \"linux\" and event.action in (\"exec\", \"exec_event\", \"fork\", \"fork_event\") and \nevent.type == \"start\" and user.name == \"postgres\" and (\n  (process.parent.args : \"*sh\" and process.parent.args : \"echo*\") or \n  (process.args : \"*sh\" and process.args : \"echo*\")\n) and not process.parent.name : \"puppet\"\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004/"}]}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}}]}}},"__N_SSG":true}