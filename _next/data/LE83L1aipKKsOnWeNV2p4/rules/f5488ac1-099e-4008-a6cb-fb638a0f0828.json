{"pageProps":{"rule":{"metadata":{"creation_date":"2023/05/12","integration":["cloud_defend"],"maturity":"production","updated_date":"2024/05/21"},"rule":{"author":["Elastic"],"description":"This rule detects an incoming SSH connection established inside a running container. Running an ssh daemon inside a\ncontainer should be avoided and monitored closely if necessary. If an attacker gains valid credentials they can use it\nto gain initial access or establish persistence within a compromised environment.\n","false_positives":["    SSH usage may be legitimate depending on the environment. Access patterns and follow-on activity should be analyzed\n    to distinguish between authorized and potentially malicious behavior.\n    "],"from":"now-6m","index":["logs-cloud_defend*"],"interval":"5m","language":"eql","license":"Elastic License v2","name":"SSH Connection Established Inside A Running Container","references":["https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/SSH%20server%20running%20inside%20container/"],"risk_score":73,"rule_id":"f5488ac1-099e-4008-a6cb-fb638a0f0828","severity":"high","tags":["Data Source: Elastic Defend for Containers","Domain: Container","OS: Linux","Use Case: Threat Detection","Tactic: Initial Access","Tactic: Lateral Movement"],"timestamp_override":"event.ingested","type":"eql","query":"process where container.id: \"*\" and event.type == \"start\" and \n\n/* use of sshd to enter a container*/\nprocess.entry_leader.entry_meta.type: \"sshd\"  and \n\n/* process is the initial process run in a container or start of a new session*/\n(process.entry_leader.same_as_process== true or process.session_leader.same_as_process== true) and \n\n/* interactive process*/\nprocess.interactive== true\n","threat":[{"framework":"MITRE ATT&CK","technique":[{"id":"T1133","name":"External Remote Services","reference":"https://attack.mitre.org/techniques/T1133/"}],"tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"}},{"framework":"MITRE ATT&CK","technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021/","subtechnique":[{"id":"T1021.004","name":"SSH","reference":"https://attack.mitre.org/techniques/T1021/004/"}]}],"tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008/"}}]}}},"__N_SSG":true}