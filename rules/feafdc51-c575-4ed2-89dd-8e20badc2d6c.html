<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Home</title><meta name="next-head-count" content="3"/><meta name="description" content="Detection Rules is the home for rules used by Elastic Security."/><meta property="og:title" content="Elastic Detection Rules"/><meta property="og:description" content="Detection Rules is the home for rules used by Elastic Security."/><meta property="og:url" content="https://github.com/elastic/detection-rules"/><link rel="stylesheet" href="/detection-rules-explorer/themes/eui_theme_dark.45c087c0a7ccec8a2229.min.css" data-name="eui-theme" data-theme-name="Dark" data-theme="dark" disabled="" aria-disabled="true"/><link rel="stylesheet" href="/detection-rules-explorer/themes/eui_theme_light.3de9904404a3ccaf0ed2.min.css" data-name="eui-theme" data-theme-name="Light" data-theme="light"/><link rel="icon" type="image/png" href="/detection-rules-explorer/images/favicon/prod/favicon-16x16.png" sizes="16x16"/><link rel="icon" type="image/png" href="/detection-rules-explorer/images/favicon/prod/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="/detection-rules-explorer/images/favicon/prod/favicon-96x96.png" sizes="96x96"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/detection-rules-explorer/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/detection-rules-explorer/_next/static/chunks/webpack-d444f824b18ba952.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/main-4be6f7e434f4c65e.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/pages/_app-f608ed562a5d9c84.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/4218-ffcd6b15488cdf6f.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/8738-e43f3c136aaac828.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/1304-34d1d6ab0f19548d.js" defer=""></script><script src="/detection-rules-explorer/_next/static/chunks/pages/rules/%5Bid%5D-4ed28d85cbc13b0b.js" defer=""></script><script src="/detection-rules-explorer/_next/static/38GctHxztBxzQ7WABo9eD/_buildManifest.js" defer=""></script><script src="/detection-rules-explorer/_next/static/38GctHxztBxzQ7WABo9eD/_ssgManifest.js" defer=""></script></head><body class="guideBody"><div id="__next" data-reactroot=""><style data-emotion="css-global 2hgghz">#__next,.guideBody{min-height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="euiHeader euiHeader--default euiHeader--fixed"><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><a href="/detection-rules-explorer" class="eui-jxpcya"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-7yvbl4-euiIcon-l" role="img" aria-hidden="true"></svg><span class="euiTitle eui-z21xof-euiTitle-xxs">Elastic Security Detection Rules</span></a></div></div><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><span class="euiToolTipAnchor eui-jcaat8-euiToolTipAnchor-inlineBlock"><button class="euiButtonEmpty euiHeaderSectionItemButton eui-wvaqcf-empty-text" type="button" aria-label="Change theme"><span class="euiButtonContent euiButtonEmpty__content"><span class="euiButtonEmpty__text"><span class="euiHeaderSectionItemButton__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-4394ro-euiIcon-m" role="img" aria-hidden="true"></svg></span></span></span></button></span></div><div class="euiHeaderSectionItem"><span class="euiToolTipAnchor eui-jcaat8-euiToolTipAnchor-inlineBlock"><a class="euiButtonEmpty euiHeaderSectionItemButton eui-wvaqcf-empty-text" href="https://github.com/elastic/detection-rules" rel="noreferrer" aria-label="EUI GitHub repo"><span class="euiButtonContent euiButtonEmpty__content"><span class="euiButtonEmpty__text"><span class="euiHeaderSectionItemButton__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-2txxin-euiIcon-m" role="img" aria-hidden="true"></svg></span></span></span></a></span></div></div></div><div class="eui-gok634"><div class="eui-1kqz3nm"><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--directionRow euiFlexGroup--responsive eui-lw6o6k"><div class="euiFlexItem"><div class="euiPanel euiPanel--plain euiPanel--paddingMedium eui-1yzwxdg-euiPanel-grow-m-m-plain-hasShadow"><h1 class="euiTitle eui-smz32e-euiTitle-m">Potential Masquerading as Business App Installer</h1><div class="euiSpacer euiSpacer--s eui-78drzl-euiSpacer-s"></div><div class="euiText eui-x1zygz-euiText-s-euiTextColor-subdued">Last updated <!-- -->10 days ago<!-- --> on<!-- --> <!-- -->2025-01-15</div><div class="euiText eui-x1zygz-euiText-s-euiTextColor-subdued">Created <!-- -->a year ago<!-- --> on<!-- --> <!-- -->2023-09-01</div></div></div></div><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--directionRow euiFlexGroup--responsive eui-lw6o6k"><div class="euiFlexItem"><div class="euiPanel euiPanel--plain euiPanel--paddingMedium eui-1yzwxdg-euiPanel-grow-m-m-plain-hasShadow"><h1 class="euiTitle eui-smz32e-euiTitle-m">About</h1><div class="euiSpacer euiSpacer--l eui-p2o3x6-euiSpacer-l"></div><div class="euiText eui-1yivsv3-euiText-m">Identifies executables with names resembling legitimate business applications but lacking signatures from the original
developer. Attackers may trick users into downloading malicious executables that masquerade as legitimate applications
via malicious ads, forum posts, and tutorials, effectively gaining initial access.
</div><div class="euiSpacer euiSpacer--l eui-p2o3x6-euiSpacer-l"></div><dl class="euiDescriptionList eui-12pc6e7-euiDescriptionList-column-left" data-type="column"><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Tags</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#ee789d;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Domain: Endpoint</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#D3DAE6;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Data Source: Elastic Defend</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#6dccb1;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">OS: Windows</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#79aad9;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Use Case: Threat Detection</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#f1d86f;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Tactic: Defense Evasion</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#f1d86f;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Tactic: Initial Access</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#f1d86f;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Tactic: Execution</span></span></span><span class="euiBadge eui-n49zn7-euiBadge" style="background-color:#D3DAE6;color:#000"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiBadge__icon eui-1uiqggp-euiIcon-s-inherit-euiBadge__icon-left" role="img" aria-hidden="true"></svg><span class="euiBadge__text eui-1vg55k4-euiBadge__text">Language: eql</span></span></span></dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Severity</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><div class="euiHealth eui-qn8ayk-euiHealth-s"><div class="euiFlexGroup euiFlexGroup--gutterExtraSmall euiFlexGroup--alignItemsCenter euiFlexGroup--directionRow"><div class="euiFlexItem euiFlexItem--flexGrowZero"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1b2fr2v-euiIcon-m-subdued" role="img" aria-hidden="true"></svg></div><div class="euiFlexItem euiFlexItem--flexGrowZero">low</div></div></div></dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Risk Score</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m">21</dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">MITRE ATT&amp;CK™</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/tactics/TA0005/" target="_blank" rel="noopener noreferrer">Defense Evasion<!-- --> (<!-- -->TA0005<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a><div class="euiText eui-14lwe4a-euiText-xs"><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/techniques/T1036/" target="_blank" rel="noopener noreferrer">↳ <!-- -->Masquerading<!-- --> (<!-- -->T1036<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a></p></div><div class="euiSpacer euiSpacer--xs eui-1wffcmx-euiSpacer-xs"></div></p><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/tactics/TA0001/" target="_blank" rel="noopener noreferrer">Initial Access<!-- --> (<!-- -->TA0001<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a><div class="euiText eui-14lwe4a-euiText-xs"><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/techniques/T1189/" target="_blank" rel="noopener noreferrer">↳ <!-- -->Drive-by Compromise<!-- --> (<!-- -->T1189<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a></p></div><div class="euiSpacer euiSpacer--xs eui-1wffcmx-euiSpacer-xs"></div></p><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/tactics/TA0002/" target="_blank" rel="noopener noreferrer">Execution<!-- --> (<!-- -->TA0002<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a><div class="euiText eui-14lwe4a-euiText-xs"><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://attack.mitre.org/techniques/T1204/" target="_blank" rel="noopener noreferrer">↳ <!-- -->User Execution<!-- --> (<!-- -->T1204<!-- -->)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a></p></div><div class="euiSpacer euiSpacer--xs eui-1wffcmx-euiSpacer-xs"></div></p></dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">License</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://www.elastic.co/licensing/elastic-license" target="_blank" rel="noopener">Elastic License v2<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a></dd></dl></div></div><div class="euiFlexItem"><div class="euiPanel euiPanel--plain euiPanel--paddingMedium eui-1yzwxdg-euiPanel-grow-m-m-plain-hasShadow"><h1 class="euiTitle eui-smz32e-euiTitle-m">Definition</h1><div class="euiSpacer euiSpacer--l eui-p2o3x6-euiSpacer-l"></div><dl class="euiDescriptionList eui-12pc6e7-euiDescriptionList-column-left" data-type="column"><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Rule Type</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m">Event Correlation Rule</dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Integration Pack</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m">Prebuilt Security Detection Rules</dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Index Patterns</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><span class="euiBadge eui-1yifmy7-euiBadge-hollow"><span class="euiBadge__content eui-1yj2yi7-euiBadge__content"><span class="euiBadge__text eui-1vg55k4-euiBadge__text">logs-endpoint.events.process-*</span></span></span></dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Related Integrations</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"><p><a class="euiLink eui-zxmf4e-euiLink-primary" href="https://docs.elastic.co/en/integrations/endpoint" target="_blank" rel="noopener">endpoint<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a></p></dd><dt class="euiDescriptionList__title eui-nd7d6t-euiDescriptionList__title-column-m-normal">Query</dt><dd class="euiDescriptionList__description eui-k4vc05-euiDescriptionList__description-column-normal-m"></dd></dl><div class="euiSpacer euiSpacer--m eui-jv9za2-euiSpacer-m"></div><div class="euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingLarge"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePreWrap" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="text"><span class="euiCodeBlock__line">process where host.os.type == &quot;windows&quot; and
</span><span class="euiCodeBlock__line">  event.type == &quot;start&quot; and process.executable : &quot;?:\\Users\\*\\Downloads\\*&quot; and
</span><span class="euiCodeBlock__line">  not process.code_signature.status : (&quot;errorCode_endpoint*&quot;, &quot;errorUntrustedRoot&quot;, &quot;errorChaining&quot;) and
</span><span class="euiCodeBlock__line">  (
</span><span class="euiCodeBlock__line">    /* Slack */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*slack*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name in (
</span><span class="euiCodeBlock__line">        &quot;Slack Technologies, Inc.&quot;,
</span><span class="euiCodeBlock__line">        &quot;Slack Technologies, LLC&quot;
</span><span class="euiCodeBlock__line">       ) and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* WebEx */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*webex*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name in (&quot;Cisco WebEx LLC&quot;, &quot;Cisco Systems, Inc.&quot;) and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Teams */
</span><span class="euiCodeBlock__line">    (process.name : &quot;teams*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Microsoft Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Discord */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*discord*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Discord Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* WhatsApp */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*whatsapp*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name in (
</span><span class="euiCodeBlock__line">        &quot;WhatsApp LLC&quot;,
</span><span class="euiCodeBlock__line">        &quot;WhatsApp, Inc&quot;,
</span><span class="euiCodeBlock__line">        &quot;24803D75-212C-471A-BC57-9EF86AB91435&quot;
</span><span class="euiCodeBlock__line">       ) and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Zoom */
</span><span class="euiCodeBlock__line">    (process.name : (&quot;*zoom*installer*.exe&quot;, &quot;*zoom*setup*.exe&quot;, &quot;zoom.exe&quot;)  and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Zoom Video Communications, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Outlook */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*outlook*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (
</span><span class="euiCodeBlock__line">        (process.code_signature.subject_name == &quot;Microsoft Corporation&quot; and process.code_signature.trusted == true) or
</span><span class="euiCodeBlock__line">        (
</span><span class="euiCodeBlock__line">          process.name: &quot;MSOutlookHelp-PST-Viewer.exe&quot; and process.code_signature.subject_name == &quot;Aryson Technologies Pvt. Ltd&quot; and
</span><span class="euiCodeBlock__line">          process.code_signature.trusted == true
</span><span class="euiCodeBlock__line">        )
</span><span class="euiCodeBlock__line">      )
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Thunderbird */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*thunderbird*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Mozilla Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Grammarly */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*grammarly*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Grammarly, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Dropbox */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*dropbox*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Dropbox, Inc&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Tableau */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*tableau*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Tableau Software LLC&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Google Drive */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*googledrive*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Google LLC&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* MSOffice */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*office*setup*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Microsoft Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Okta */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*okta*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Okta, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* OneDrive */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*onedrive*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Microsoft Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Chrome */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*chrome*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name in (&quot;Google LLC&quot;, &quot;Google Inc&quot;) and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Firefox */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*firefox*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Mozilla Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Edge */
</span><span class="euiCodeBlock__line">    (process.name : (&quot;*microsoftedge*.exe&quot;, &quot;*msedge*.exe&quot;) and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Microsoft Corporation&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Brave */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*brave*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Brave Software, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* GoogleCloud Related Tools */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*GoogleCloud*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Google LLC&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Github Related Tools */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*github*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;GitHub, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    ) or
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">    /* Notion */
</span><span class="euiCodeBlock__line">    (process.name : &quot;*notion*.exe&quot; and not
</span><span class="euiCodeBlock__line">      (process.code_signature.subject_name == &quot;Notion Labs, Inc.&quot; and process.code_signature.trusted == true)
</span><span class="euiCodeBlock__line">    )
</span><span class="euiCodeBlock__line">  )
</span><span class="euiCodeBlock__line"></span></code></pre></div></div></div></div><div class="euiPanel euiPanel--primary euiPanel--paddingMedium euiCallOut euiCallOut--primary eui-1htmxq-euiPanel-none-m-primary-euiCallOut"><p class="euiTitle euiCallOutHeader__title eui-akxjbi-euiTitle-xs-euiCallOutHeader-primary"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-vlvl53-euiIcon-m-inherit-euiCallOut__icon" role="img" aria-hidden="true"></svg>Install detection rules in Elastic Security</p><div class="euiText eui-1hexw8x-euiText-s-euiTextColor-default-euiCallOut__description"><div class="euiSpacer euiSpacer--s eui-78drzl-euiSpacer-s"></div><p>Detect <!-- -->Potential Masquerading as Business App Installer<!-- --> in the Elastic Security detection engine by installing this rule into your Elastic Stack.</p><p>To setup this rule, check out the installation guide for<!-- --> <a class="euiLink eui-zxmf4e-euiLink-primary" href="https://www.elastic.co/guide/en/security/current/prebuilt-rules-management.html" target="_blank" rel="noopener">Prebuilt Security Detection Rules<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon eui-1ed6zfh-euiIcon-s-euiLink__externalIcon" role="img" aria-label="External link" aria-hidden="true"></svg><span class="eui-194jjcc-euiScreenReaderOnly-euiLink__screenReaderText">(opens in a new tab or window)</span></a>.</p></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"rule":{"metadata":{"creation_date":"2023/09/01","integration":["endpoint"],"maturity":"production","updated_date":"2025/01/15"},"rule":{"author":["Elastic"],"description":"Identifies executables with names resembling legitimate business applications but lacking signatures from the original\ndeveloper. Attackers may trick users into downloading malicious executables that masquerade as legitimate applications\nvia malicious ads, forum posts, and tutorials, effectively gaining initial access.\n","from":"now-9m","index":["logs-endpoint.events.process-*"],"language":"eql","license":"Elastic License v2","name":"Potential Masquerading as Business App Installer","references":["https://www.rapid7.com/blog/post/2023/08/31/fake-update-utilizes-new-idat-loader-to-execute-stealc-and-lumma-infostealers"],"risk_score":21,"rule_id":"feafdc51-c575-4ed2-89dd-8e20badc2d6c","severity":"low","tags":["Domain: Endpoint","Data Source: Elastic Defend","OS: Windows","Use Case: Threat Detection","Tactic: Defense Evasion","Tactic: Initial Access","Tactic: Execution","Resources: Investigation Guide","Language: eql"],"timestamp_override":"event.ingested","type":"eql","query":"process where host.os.type == \"windows\" and\n  event.type == \"start\" and process.executable : \"?:\\\\Users\\\\*\\\\Downloads\\\\*\" and\n  not process.code_signature.status : (\"errorCode_endpoint*\", \"errorUntrustedRoot\", \"errorChaining\") and\n  (\n    /* Slack */\n    (process.name : \"*slack*.exe\" and not\n      (process.code_signature.subject_name in (\n        \"Slack Technologies, Inc.\",\n        \"Slack Technologies, LLC\"\n       ) and process.code_signature.trusted == true)\n    ) or\n\n    /* WebEx */\n    (process.name : \"*webex*.exe\" and not\n      (process.code_signature.subject_name in (\"Cisco WebEx LLC\", \"Cisco Systems, Inc.\") and process.code_signature.trusted == true)\n    ) or\n\n    /* Teams */\n    (process.name : \"teams*.exe\" and not\n      (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Discord */\n    (process.name : \"*discord*.exe\" and not\n      (process.code_signature.subject_name == \"Discord Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* WhatsApp */\n    (process.name : \"*whatsapp*.exe\" and not\n      (process.code_signature.subject_name in (\n        \"WhatsApp LLC\",\n        \"WhatsApp, Inc\",\n        \"24803D75-212C-471A-BC57-9EF86AB91435\"\n       ) and process.code_signature.trusted == true)\n    ) or\n\n    /* Zoom */\n    (process.name : (\"*zoom*installer*.exe\", \"*zoom*setup*.exe\", \"zoom.exe\")  and not\n      (process.code_signature.subject_name == \"Zoom Video Communications, Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Outlook */\n    (process.name : \"*outlook*.exe\" and not\n      (\n        (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true) or\n        (\n          process.name: \"MSOutlookHelp-PST-Viewer.exe\" and process.code_signature.subject_name == \"Aryson Technologies Pvt. Ltd\" and\n          process.code_signature.trusted == true\n        )\n      )\n    ) or\n\n    /* Thunderbird */\n    (process.name : \"*thunderbird*.exe\" and not\n      (process.code_signature.subject_name == \"Mozilla Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Grammarly */\n    (process.name : \"*grammarly*.exe\" and not\n      (process.code_signature.subject_name == \"Grammarly, Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Dropbox */\n    (process.name : \"*dropbox*.exe\" and not\n      (process.code_signature.subject_name == \"Dropbox, Inc\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Tableau */\n    (process.name : \"*tableau*.exe\" and not\n      (process.code_signature.subject_name == \"Tableau Software LLC\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Google Drive */\n    (process.name : \"*googledrive*.exe\" and not\n      (process.code_signature.subject_name == \"Google LLC\" and process.code_signature.trusted == true)\n    ) or\n\n    /* MSOffice */\n    (process.name : \"*office*setup*.exe\" and not\n      (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Okta */\n    (process.name : \"*okta*.exe\" and not\n      (process.code_signature.subject_name == \"Okta, Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* OneDrive */\n    (process.name : \"*onedrive*.exe\" and not\n      (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Chrome */\n    (process.name : \"*chrome*.exe\" and not\n      (process.code_signature.subject_name in (\"Google LLC\", \"Google Inc\") and process.code_signature.trusted == true)\n    ) or\n\n    /* Firefox */\n    (process.name : \"*firefox*.exe\" and not\n      (process.code_signature.subject_name == \"Mozilla Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Edge */\n    (process.name : (\"*microsoftedge*.exe\", \"*msedge*.exe\") and not\n      (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Brave */\n    (process.name : \"*brave*.exe\" and not\n      (process.code_signature.subject_name == \"Brave Software, Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* GoogleCloud Related Tools */\n    (process.name : \"*GoogleCloud*.exe\" and not\n      (process.code_signature.subject_name == \"Google LLC\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Github Related Tools */\n    (process.name : \"*github*.exe\" and not\n      (process.code_signature.subject_name == \"GitHub, Inc.\" and process.code_signature.trusted == true)\n    ) or\n\n    /* Notion */\n    (process.name : \"*notion*.exe\" and not\n      (process.code_signature.subject_name == \"Notion Labs, Inc.\" and process.code_signature.trusted == true)\n    )\n  )\n","note":"## Triage and analysis\n\n\u003e **Disclaimer**:\n\u003e This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.\n\n### Investigating Potential Masquerading as Business App Installer\n\nBusiness applications are integral to productivity, often downloaded and installed by users. Adversaries exploit this by creating malicious executables with names mimicking legitimate apps, tricking users into installing them. The detection rule identifies such threats by checking for unsigned executables in download directories, ensuring they don't masquerade as trusted applications.\n\n### Possible investigation steps\n\n- Review the process name and executable path to confirm if it matches any known legitimate business application names listed in the rule, such as Slack, WebEx, or Teams, and verify if it was executed from a typical download directory.\n- Check the process code signature status and subject name to determine if the executable is unsigned or signed by an untrusted entity, which could indicate a masquerading attempt.\n- Investigate the source of the download by examining browser history, email attachments, or any recent file transfers to identify potential phishing attempts or malicious download sources.\n- Analyze the process execution context, including parent processes and command-line arguments, to understand how the executable was launched and if it aligns with typical user behavior.\n- Look for any network connections initiated by the process to identify suspicious outbound traffic or connections to known malicious IP addresses or domains.\n- Cross-reference the executable's hash with threat intelligence databases to check for known malware signatures or previous reports of malicious activity.\n- If the executable is determined to be suspicious, isolate the affected system and perform a full malware scan to prevent further compromise.\n\n### False positive analysis\n\n- Unsigned executables from legitimate developers may trigger alerts if they are not properly signed or if the signature is not recognized. Users can create exceptions for specific executables by verifying the developer's authenticity and adding them to a trusted list.\n- Custom or in-house developed applications that mimic business app names but are unsigned can cause false positives. Organizations should ensure these applications are signed with a trusted certificate or add them to an exclusion list after verifying their safety.\n- Software updates or beta versions of legitimate applications might not have updated signatures, leading to false positives. Users should verify the source of the update and, if legitimate, temporarily exclude these versions from the rule.\n- Applications installed in non-standard directories that match the naming patterns but are legitimate can be excluded by specifying trusted paths or directories in the rule configuration.\n- Third-party tools or utilities that integrate with business applications and use similar naming conventions might be flagged. Users should verify these tools and, if safe, add them to an exception list to prevent future alerts.\n\n### Response and remediation\n\n- Isolate the affected system from the network to prevent further spread of the potential threat and to contain any malicious activity.\n- Terminate the suspicious process identified by the alert to stop any ongoing malicious actions.\n- Quarantine the executable file flagged by the detection rule to prevent execution and further analysis.\n- Conduct a thorough scan of the affected system using updated antivirus or endpoint detection and response (EDR) tools to identify and remove any additional malicious files or remnants.\n- Review and analyze the process execution logs and any related network activity to understand the scope of the intrusion and identify any other potentially compromised systems.\n- Escalate the incident to the security operations center (SOC) or incident response team for further investigation and to determine if additional systems are affected.\n- Implement application whitelisting to prevent unauthorized executables from running, ensuring only trusted and signed applications are allowed to execute.","threat":[{"framework":"MITRE ATT\u0026CK","technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036/","subtechnique":[{"id":"T1036.001","name":"Invalid Code Signature","reference":"https://attack.mitre.org/techniques/T1036/001/"},{"id":"T1036.005","name":"Match Legitimate Name or Location","reference":"https://attack.mitre.org/techniques/T1036/005/"}]}],"tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"}},{"framework":"MITRE ATT\u0026CK","technique":[{"id":"T1189","name":"Drive-by Compromise","reference":"https://attack.mitre.org/techniques/T1189/"}],"tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"}},{"framework":"MITRE ATT\u0026CK","technique":[{"id":"T1204","name":"User Execution","reference":"https://attack.mitre.org/techniques/T1204/","subtechnique":[{"id":"T1204.002","name":"Malicious File","reference":"https://attack.mitre.org/techniques/T1204/002/"}]}],"tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"}}]}}},"__N_SSG":true},"page":"/rules/[id]","query":{"id":"feafdc51-c575-4ed2-89dd-8e20badc2d6c"},"buildId":"38GctHxztBxzQ7WABo9eD","assetPrefix":"/detection-rules-explorer","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>